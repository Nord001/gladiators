<?xml version="1.0" encoding="Windows-1251"?>
<form table="chat_settings" title_rus="јдминистрирование бана" title_eng="Ban administration">

<select
sql="select a.*,a.UserID as User, 
concat('&lt;a href=/users/',u2.UserID,'>',u2.Login,'&lt;/a>') Admin,
concat('&lt;a href=/users/',u.UserID,'>',u.Login,'&lt;/a>') Login,

a.BanTime as DateBan 
from chat_settings a 
join ut_users u on u.UserID=a.UserID 
left outer join ut_users u2 on u2.UserID=a.AdminID
where a.BanTime>unix_timestamp(); 
order by BanTime asc">

 <header>

     <item
	name="Login"
	name_rus="Ћогин"
	name_eng="Login">
     </item>

     <item
	name="DateBan"
	name_rus="Ѕан до"
	name_eng="End for Ban"
	type="date"
	format="d.m.Y H:i">
     </item>

     <item
	name="Admin"
	name_rus=" ем забанен"
	name_eng="Who banned">
     </item>


 </header>

</select>


 <insert
sql="set @UserID=(select UserID from ut_users where Login=@Login; and @Login&lt;>'' limit 0,1)
#set @error=(if((@UserID='' or @UserID is null),'ѕользователь не найден',0))
#insert into chat_settings(UserID,BanTime,AdminID) values (@userID,unix_timestamp()+$time_ban;,'$auth->user;')
on duplicate key update BanTime=unix_timestamp()+$time_ban;, AdminID='$auth->user;'"
title_rus="”становить бан пользователю в чате" 
title_eng=" "
success_rus="Ѕан в чате поставлен">

   <fields>

       <field
      name="Login"
      name_rus="Ћогин"
      type="string"
      needed="1">
    </field>

    <field
      name="time_ban"
      name_rus="—рок бана"
      name_eng="Ban time"
	type="list"
	vars="сн€ть бан;10 мин;30 мин;1 час;6 часов;1 сутки;5 дней;10 дней;30 дней;2 мес€ца;3 мес€ца;6 мес€цев;12 мес€цев;5 лет"
	vals="1;600;1800;3600;21600;86400;432000;864000;2592000;5184000;7776000;15552000;31536000;157680000">
    </field>

   </fields>

   <button
       name_rus="”становить бан"
       name_eng="Confirm">
   </button> 

 </insert>


</form>